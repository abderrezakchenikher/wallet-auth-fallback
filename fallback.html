<!DOCTYPE html> 
<html lang="fr">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Redirection Wallet</title>
   <script>
       async function openWallet() {
           // Récupérer l'URL de la page avec les paramètres
           const params = new URLSearchParams(window.location.search);
           const oobData = params.get('_oob');
           const urlData = params.get('_url');

           if (!oobData && !urlData) {
               alert("Paramètre '_oob' ou '_url' manquant !");
               return;
           }

           // Base de l'URL du wallet
           let httpsUrl = "https://rttdz.wuaze.com/wallet/?";

           // Construction de l'URL selon le paramètre disponible
           if (oobData) {
               httpsUrl += `oob=${oobData}`;
           } else {
               httpsUrl += `_url=${urlData}`;
           }

           try {
               // Vérifier si l'URL est accessible avec un statut HTTP 200
               const response = await fetch(httpsUrl, { method: 'HEAD', mode: 'no-cors' });

               if (response.ok) {
                   // Si l'URL répond correctement, rediriger vers le Wallet
                   window.location.href = httpsUrl;
               }
           } catch (error) {
               console.warn("Échec de l'accès à l'URL du Wallet, redirection vers le store.");
               
               // Redirection vers le store après 3 secondes
               setTimeout(() => {
                   const storeUrl = navigator.userAgent.includes('iPhone')
                       ? 'https://www.quebec.ca/'  // Remplace par l'URL réelle de l'App Store
                       : 'https://www.quebec.ca/';  // Remplace par l'URL réelle du Play Store

                   window.location.href = storeUrl;
               }, 3000);
           }
       }
   </script>
</head>
<body onload="openWallet()">
   <h2>Redirection en cours...</h2>
</body>
</html>
