<!DOCTYPE html> 
<html lang="fr">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Redirection Wallet</title>
   <script>
       function openWallet() {
           // Récupérer les paramètres de l'URL
           const params = new URLSearchParams(window.location.search);
           const oobData = params.get('_oob');
           const urlData = params.get('_url');

           if (!oobData && !urlData) {
               alert("Paramètre '_oob' ou '_url' manquant !");
               return;
           }

           // Construire l'URL pour le deep link
           let deepLink = "rttdz.wuaze.com://wallet/?";

           if (oobData) {
               deepLink += `oob=${encodeURIComponent(oobData)}`;
           } else {
               deepLink += `_url=${encodeURIComponent(urlData)}`;
           }

           // URL HTTPS fallback si l'application n'est pas installée
           let httpsUrl = `https://rttdz.wuaze.com/wallet/?`;
           if (oobData) {
               httpsUrl += `oob=${encodeURIComponent(oobData)}`;
           } else {
               httpsUrl += `_url=${encodeURIComponent(urlData)}`;
           }

           // Déterminer l'URL de fallback (store)
           const storeUrl = navigator.userAgent.includes('iPhone')
               ? 'https://apps.apple.com/app/idXXXXXXXXX'  // Remplace avec l'App Store ID
               : 'https://play.google.com/store/apps/details?id=com.walletbc';  // Remplace avec le package name Android

           // Tentative d'ouverture de l'application Wallet
           const startTime = new Date().getTime();
           window.location.href = deepLink;

           // Vérifier si l'application est installée (si l'utilisateur ne quitte pas la page)
           setTimeout(() => {
               const elapsed = new Date().getTime() - startTime;
               if (elapsed < 2000) {
                   // L'application n'est probablement pas installée, redirige vers le store
                   window.location.href = storeUrl;
               }
           }, 1500);
       }
   </script>
</head>
<body onload="openWallet()">
   <h2>Redirection en cours...</h2>
</body>
</html>
