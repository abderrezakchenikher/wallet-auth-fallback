<!DOCTYPE html> 
<html lang="fr">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Redirection Wallet</title>
   <script>
       function openWallet() {
           // Récupérer les paramètres de l'URL
           const params = new URLSearchParams(window.location.search);
           const oobData = params.get('_oob');
           const urlData = params.get('_url');

           if (!oobData && !urlData) {
               alert("Paramètre '_oob' ou '_url' manquant !");
               return;
           }

           // Construire l'URL universelle HTTPS
           let universalLink = "https://rttdz.wuaze.com/wallet/?";
           if (oobData) {
               universalLink += `oob=${encodeURIComponent(oobData)}`;
           } else {
               universalLink += `_url=${encodeURIComponent(urlData)}`;
           }

           // Déterminer l'URL de fallback (store)
           const storeUrl = navigator.userAgent.includes('iPhone')
               ? 'https://apps.apple.com/app/idXXXXXXXXX'  // Remplace avec ton App Store ID
               : 'https://play.google.com/store/apps/details?id=com.walletbc';  // Remplace avec le package Android

           // Création d'un iframe invisible pour tenter d'ouvrir l'application
           const iframe = document.createElement("iframe");
           iframe.style.display = "none";
           iframe.src = universalLink;
           document.body.appendChild(iframe);

           // Vérification après 1.5s si l'application s'est ouverte
           const startTime = new Date().getTime();
           
           setTimeout(() => {
               const elapsed = new Date().getTime() - startTime;
               if (elapsed < 2000) {
                   // L'application ne s'est pas ouverte, redirection vers le Store
                   window.location.href = storeUrl;
               }
           }, 1500);
       }
   </script>
</head>
<body onload="openWallet()">
   <h2>Redirection en cours...</h2>
</body>
</html>
