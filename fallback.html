<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirection Wallet</title>
<script> 
    function openWallet() {
        // Récupérer l'URL de la page avec les paramètres
        const params = new URLSearchParams(window.location.search);
        const oobData = params.get('oob');
        //const baseUrl = params.get('baseUrl'); // Extraction de baseUrl depuis les paramètres

        if (!oobData) {
            alert("Données OOB ou baseUrl manquantes !");
            return;
        }
       const baseUrl = window.location.hostname;
        // Construire l'URL DIDComm en utilisant baseUrl des paramètres
        const didcommUrl = `didcomm://${baseUrl}?oob=${oobData}`;

        // Essayer d'ouvrir Wallet
        window.location.href = didcommUrl;

        // Si Wallet n'est pas installé, rediriger après 3 secondes
        setTimeout(() => {
            const storeUrl = navigator.userAgent.includes('iPhone') 
                ? 'https://www.quebec.ca/' // Remplace avec l'ID réel de ton app
                : 'https://www.quebec.ca/'; // Remplace avec le package Android
            window.location.href = storeUrl;
        }, 3000);
    }
</script>

</head>
<body onload="openWallet()">
    <h2>Redirection en cours...</h2>
</body>
</html>
