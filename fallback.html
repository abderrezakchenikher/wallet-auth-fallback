<!DOCTYPE html> 
<html lang="fr">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Redirection Wallet</title>
   <script>
       function openWallet() {
           // Récupérer les paramètres de l'URL
           const params = new URLSearchParams(window.location.search);
           const oobData = params.get('_oob');
           const urlData = params.get('_url');

           if (!oobData && !urlData) {
               alert("Paramètre '_oob' ou '_url' manquant !");
               return;
           }

           // Construire l'URL universelle HTTPS pour iOS et les navigateurs modernes
           let universalLink = "https://rttdz.wuaze.com/wallet/?";
           if (oobData) {
               universalLink += `oob=${encodeURIComponent(oobData)}`;
           } else {
               universalLink += `_url=${encodeURIComponent(urlData)}`;
           }

           // Intent Link pour Android (remplace `com.walletbc` par le package réel de ton app)
           let intentLink = `intent://rttdz.wuaze.com/wallet/?`;
           if (oobData) {
               intentLink += `oob=${encodeURIComponent(oobData)}`;
           } else {
               intentLink += `_url=${encodeURIComponent(urlData)}`;
           }
           intentLink += `#Intent;scheme=https;package=com.walletbc;end;`;

           // Déterminer l'URL de fallback (store)
           const storeUrl = navigator.userAgent.includes('iPhone')
               ? 'https://apps.apple.com/app/idXXXXXXXXX'  // Remplace avec ton App Store ID
               : 'https://play.google.com/store/apps/details?id=com.walletbc';  // Remplace avec ton package Android

           // Vérifier si c'est un appareil Android
           const isAndroid = /Android/i.test(navigator.userAgent);
           const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

           const startTime = new Date().getTime();

           if (isAndroid) {
               // Rediriger vers Intent Link pour Android
               window.location.href = intentLink;
           } else if (isIOS) {
               // Rediriger vers Universal Link pour iOS
               window.location.href = universalLink;
           } else {
               // Pour d'autres plateformes, utiliser le lien HTTPS
               window.location.href = universalLink;
           }

           // Vérification après 1.5s si l'application s'est ouverte
           setTimeout(() => {
               const elapsed = new Date().getTime() - startTime;
               if (elapsed < 2000) {
                   // L'application ne s'est pas ouverte, redirection vers le Store
                   window.location.href = storeUrl;
               }
           }, 1500);
       }
   </script>
</head>
<body onload="openWallet()">
   <h2>Redirection en cours...</h2>
</body>
</html>
